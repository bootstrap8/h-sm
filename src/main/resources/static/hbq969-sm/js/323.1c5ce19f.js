"use strict";(self["webpackChunkstatic"]=self["webpackChunkstatic"]||[]).push([[323],{323:function(e,a,l){l.r(a),l.d(a,{default:function(){return f}});var t=l(3396),o=l(4870),r=l(2748),n=l(1728),d=l(4834);const s={class:"container"},i={class:"dialog-footer"},u={class:"dialog-footer"};var m=(0,t.aZ)({__name:"Role",setup(e){(0,o.iH)("140px");const a=(0,o.qj)({pageNum:1,pageSize:10,name:"",desc:""}),l=(0,o.qj)({roles:[],total:0,menus:[]}),m=()=>{(0,n.Z)({url:"/roles/list",method:"post",data:a,params:{pageNum:a.pageNum,pageSize:a.pageSize}}).then((e=>{"OK"==e.data.state?(l.roles=e.data.body.list,l.total=e.data.body.total):(0,d.WI)(e.data.errorMessage,"warning")})).catch((e=>{(0,d.WI)("请求异常","error")}))},p=(0,o.iH)(!1),c=(0,o.iH)("新增角色"),f=(0,o.qj)({name:"",desc:""}),g=(0,o.iH)(),w=(0,o.qj)({name:[{required:!0,message:"不能为空",trigger:"blur"}]}),b=async e=>{e&&await e.validate(((e,a)=>{e&&(0,n.Z)({url:"/roles/role",method:"新增角色"==c.value?"post":"put",data:f}).then((e=>{"OK"==e.data.state?((0,d.WI)(e.data.body,"success"),p.value=!1,m()):(0,d.WI)(e.data.errorMessage,"warning")})).catch((e=>{(0,d.WI)("请求异常","error")}))}))},h=()=>{p.value=!0,c.value="新增角色",f.name="",f.desc=""},W=e=>{p.value=!0,c.value="编辑角色",f.name=e.row.name,f.desc=e.row.desc},v=e=>{(0,n.Z)({url:"/roles/role",method:"delete",params:{name:e.row.name}}).then((e=>{"OK"==e.data.state?((0,d.WI)(e.data.body,"success"),m()):(0,d.WI)(e.data.errorMessage,"warning")})).catch((e=>{(0,d.WI)("请求异常","error")}))},k=(0,o.iH)(!1),y=(0,o.iH)("配置菜单"),_=(0,o.iH)(["待选择","已选择"]),U=(0,o.qj)({role:{name:""},menus:[],mapTo:function(){this.menus=this.menus.map((e=>({name:e})))}}),z=(0,o.iH)(),C=(0,o.qj)({name:[{required:!0,message:"不能为空",trigger:"blur"}]}),V=async e=>{e&&await e.validate(((e,a)=>{e&&(U.mapTo(),(0,n.Z)({url:"/roles/role/menus",method:"post",data:U}).then((e=>{"OK"==e.data.state?((0,d.WI)(e.data.body,"success"),k.value=!1):(0,d.WI)(e.data.errorMessage,"warning")})).catch((e=>{(0,d.WI)("请求异常","error")})))}))},I=e=>{k.value=!0,y.value="配置菜单("+e.row.name+")",U.role.name=e.row.name,(0,n.Z)({url:"/roles/role/menus",method:"get",params:{name:e.row.name}}).then((e=>{"OK"==e.data.state?(l.menus=e.data.body.all,U.menus=e.data.body.conf,console.log("all: %o, conf: %o",l.menus,U.menus)):(0,d.WI)(e.data.errorMessage,"warning")})).catch((e=>{(0,d.WI)("请求异常","error")}))},x=()=>({backgroundColor:"#f5f5f5",color:"#333",fontWeight:"bold"});(0,t.bv)((()=>{console.log("页面加载后"),m()}));const N=(e,a)=>{let l;return function(...t){const o=self;l&&clearTimeout(l),l=setTimeout((()=>{e.apply(o,t)}),a)}},q=window.ResizeObserver;return window.ResizeObserver=class extends q{constructor(e){e=N(e,20),super(e)}},(e,n)=>{const d=(0,t.up)("el-divider"),N=(0,t.up)("el-input"),q=(0,t.up)("el-form-item"),H=(0,t.up)("el-button"),M=(0,t.up)("el-form"),S=(0,t.up)("el-popconfirm"),j=(0,t.up)("el-table-column"),O=(0,t.up)("el-table"),Z=(0,t.up)("el-pagination"),A=(0,t.up)("el-dialog"),K=(0,t.up)("el-transfer");return(0,t.wg)(),(0,t.iD)("div",s,[(0,t.Wm)(d,{"content-position":"left"},{default:(0,t.w5)((()=>[(0,t.Uk)("查询条件")])),_:1}),(0,t.Wm)(M,{model:a,size:"small","label-position":"right","inline-message":"",inline:""},{default:(0,t.w5)((()=>[(0,t.Wm)(q,{label:"角色名称",prop:"name"},{default:(0,t.w5)((()=>[(0,t.Wm)(N,{modelValue:a.name,"onUpdate:modelValue":n[0]||(n[0]=e=>a.name=e),placeholder:"请输入...",type:"text"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(q,{label:"角色描述",prop:"desc"},{default:(0,t.w5)((()=>[(0,t.Wm)(N,{modelValue:a.desc,"onUpdate:modelValue":n[1]||(n[1]=e=>a.desc=e),placeholder:"请输入...",type:"text"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(q,null,{default:(0,t.w5)((()=>[(0,t.Wm)(H,{type:"primary",size:"small",onClick:n[2]||(n[2]=e=>m())},{default:(0,t.w5)((()=>[(0,t.Uk)("查询")])),_:1}),(0,t.Wm)(H,{type:"success",icon:(0,o.SU)(r.I8b),circle:"",onClick:n[3]||(n[3]=e=>h()),title:"新增角色"},null,8,["icon"])])),_:1})])),_:1},8,["model"]),(0,t.Wm)(d,{"content-position":"left"},{default:(0,t.w5)((()=>[(0,t.Uk)("查询结果")])),_:1}),(0,t.Wm)(O,{data:l.roles,style:{width:"100%"},border:!0,"table-layout":"fixed",stripe:!0,size:"small","highlight-current-row":!0,"header-cell-style":x},{default:(0,t.w5)((()=>[(0,t.Wm)(j,{fixed:"left",label:"操作",width:"180","header-align":"center",align:"center"},{default:(0,t.w5)((e=>[(0,t.Wm)(H,{link:"",type:"primary",size:"small",onClick:a=>W(e),disabled:"ADMIN"==e.row.name},{default:(0,t.w5)((()=>[(0,t.Uk)("编辑 ")])),_:2},1032,["onClick","disabled"]),(0,t.Wm)(S,{title:"删除角色会把关联的账号全部删除，请确认是否删除?",onConfirm:a=>v(e),"icon-color":"red","confirm-button-type":"danger"},{reference:(0,t.w5)((()=>[(0,t.Wm)(H,{link:"",type:"danger",size:"small",disabled:"ADMIN"==e.row.name},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:2},1032,["disabled"])])),_:2},1032,["onConfirm"]),(0,t.Wm)(H,{link:"",type:"primary",size:"small",onClick:a=>I(e),disabled:"ADMIN"==e.row.name},{default:(0,t.w5)((()=>[(0,t.Uk)("配置菜单 ")])),_:2},1032,["onClick","disabled"])])),_:1}),(0,t.Wm)(j,{prop:"name",label:"名称","show-overflow-tooltip":!0,"header-align":"center",align:"center"}),(0,t.Wm)(j,{prop:"desc",label:"描述","show-overflow-tooltip":!0,"header-align":"center",align:"center"}),(0,t.Wm)(j,{prop:"fmtCreatedAt",label:"创建时间","show-overflow-tooltip":!0,"header-align":"center",align:"center"}),(0,t.Wm)(j,{prop:"fmtUpdatedAt",label:"修改时间","show-overflow-tooltip":!0,"header-align":"center",align:"center"})])),_:1},8,["data"]),(0,t.Wm)(Z,{class:"page","page-size":a.pageSize,"onUpdate:pageSize":n[4]||(n[4]=e=>a.pageSize=e),"current-page":a.pageNum,"onUpdate:currentPage":n[5]||(n[5]=e=>a.pageNum=e),layout:"->, total, sizes, prev, pager, next, jumper",total:l.total,"onUpdate:total":n[6]||(n[6]=e=>l.total=e),onSizeChange:n[7]||(n[7]=e=>m()),onCurrentChange:n[8]||(n[8]=e=>m()),onPrevClick:n[9]||(n[9]=e=>m()),onNextClick:n[10]||(n[10]=e=>m()),small:!0,background:!0,"page-sizes":[5,10,20,50,100]},null,8,["page-size","current-page","total"]),(0,t.Wm)(A,{modelValue:p.value,"onUpdate:modelValue":n[15]||(n[15]=e=>p.value=e),title:c.value,draggable:""},{footer:(0,t.w5)((()=>[(0,t._)("span",i,[(0,t.Wm)(H,{onClick:n[13]||(n[13]=e=>p.value=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1}),(0,t.Wm)(H,{type:"primary",onClick:n[14]||(n[14]=e=>b(g.value))},{default:(0,t.w5)((()=>[(0,t.Uk)("保存")])),_:1})])])),default:(0,t.w5)((()=>[(0,t.Wm)(M,{model:f,"label-position":"right",size:"small",inline:!1,ref_key:"formRef",ref:g,rules:w,"label-width":"20%"},{default:(0,t.w5)((()=>[(0,t.Wm)(q,{label:"角色名称：",prop:"name"},{default:(0,t.w5)((()=>[(0,t.Wm)(N,{modelValue:f.name,"onUpdate:modelValue":n[11]||(n[11]=e=>f.name=e),type:"text",disabled:"编辑角色"==c.value},null,8,["modelValue","disabled"])])),_:1}),(0,t.Wm)(q,{label:"校色描述：",prop:"url"},{default:(0,t.w5)((()=>[(0,t.Wm)(N,{modelValue:f.desc,"onUpdate:modelValue":n[12]||(n[12]=e=>f.desc=e),type:"textarea",rows:"3"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),(0,t.Wm)(A,{modelValue:k.value,"onUpdate:modelValue":n[19]||(n[19]=e=>k.value=e),title:y.value,draggable:""},{footer:(0,t.w5)((()=>[(0,t._)("span",u,[(0,t.Wm)(H,{onClick:n[17]||(n[17]=e=>k.value=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1}),(0,t.Wm)(H,{type:"primary",onClick:n[18]||(n[18]=e=>V(z.value))},{default:(0,t.w5)((()=>[(0,t.Uk)("保存")])),_:1})])])),default:(0,t.w5)((()=>[(0,t.Wm)(M,{model:U,"label-position":"right",size:"small",inline:!1,ref_key:"formRef2",ref:z,rules:C,"label-width":"20%"},{default:(0,t.w5)((()=>[(0,t.Wm)(K,{modelValue:U.menus,"onUpdate:modelValue":n[16]||(n[16]=e=>U.menus=e),filterable:"","filter-method":(e,a)=>a.label.includes(e),"filter-placeholder":"输入菜单名",data:l.menus,titles:_.value},null,8,["modelValue","filter-method","data","titles"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}}),p=l(89);const c=(0,p.Z)(m,[["__scopeId","data-v-2bc7f12b"]]);var f=c}}]);
//# sourceMappingURL=323.1c5ce19f.js.map